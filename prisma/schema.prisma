generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model users {
  id                 BigInt               @id @default(autoincrement())
  name               String
  email              String               @unique
  password           String
  is_admin           Boolean              @default(false)
  row_created_at     DateTime?            @default(now()) @db.Timestamptz(6)
  row_updated_at     DateTime?            @db.Timestamptz(6)
  custom_charts      custom_charts[]
  custom_dashboards  custom_dashboards[]
  external_databases external_databases[]
}

model custom_charts {
  id             BigInt              @id @default(autoincrement())
  name           String
  sql            String
  chart_config   Json
  created_by     BigInt?
  database_id    BigInt?
  row_created_at DateTime?           @default(now()) @db.Timestamptz(6)
  row_updated_at DateTime?           @db.Timestamptz(6)
  creator        users?              @relation(fields: [created_by], references: [id])
  database       external_databases? @relation(fields: [database_id], references: [id])
}

model custom_dashboards {
  id             BigInt    @id @default(autoincrement())
  name           String
  render_config  Json
  created_by     BigInt?
  row_created_at DateTime? @default(now()) @db.Timestamptz(6)
  row_updated_at DateTime? @db.Timestamptz(6)
  creator        users?    @relation(fields: [created_by], references: [id])
}

model external_databases {
  id             BigInt          @id @default(autoincrement())
  name           String
  host           String
  port           Int             @default(5432)
  database       String
  username       String
  password       String
  ssl_enabled    Boolean         @default(false)
  created_by     BigInt?
  row_created_at DateTime?       @default(now()) @db.Timestamptz(6)
  row_updated_at DateTime?       @db.Timestamptz(6)
  creator        users?          @relation(fields: [created_by], references: [id])
  custom_charts  custom_charts[]
}